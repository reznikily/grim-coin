# –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π Grim Coin

## –í–µ—Ä—Å–∏—è 1.3 (2025-10-04) - –¢–ï–ö–£–©–ê–Ø ‚úÖ

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–∞–Ω–∏–∫–∞ "send on closed channel"
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–∞–¥–∞–ª–∞ —Å –ø–∞–Ω–∏–∫–æ–π –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ ACK –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –∫–∞–Ω–∞–ª–∞.

```
panic: send on closed channel
goroutine 18 [running]:
main.(*NetworkManager).handleAck
```

**–ü—Ä–∏—á–∏–Ω–∞:** Race condition - ACK –º–æ–≥ –ø—Ä–∏–π—Ç–∏ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –∫–∞–Ω–∞–ª –±—ã–ª —É–¥–∞–ª–µ–Ω –∏–∑ map –∏ –∑–∞–∫—Ä—ã—Ç.

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–ª–µ–Ω `recover()` –≤ `handleAck` –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –ø–∞–Ω–∏–∫–∏
2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ 10ms –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º –∫–∞–Ω–∞–ª–∞
3. –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ map –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º

```go
defer func() {
    // Remove from map first
    nm.ackMu.Lock()
    delete(nm.ackChannels, msg.MessageID)
    nm.ackMu.Unlock()
    
    // Small delay to let any pending sends complete
    time.Sleep(10 * time.Millisecond)
    close(ackCh)
}()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ù–µ—Ç –ø–∞–Ω–∏–∫, —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞

---

## –í–µ—Ä—Å–∏—è 1.2 (2025-10-04)

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å ACK –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è–º–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–ª–∏—Å—å –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º, –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –¥–µ–ª–∞–ª 5 —Ä–µ—Ç—Ä–∞–µ–≤ –∏ –ø–æ–ª—É—á–∞–ª –æ—à–∏–±–∫—É.

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `listenLoop()` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è `remoteAddr` –∏–∑ UDP –ø–∞–∫–µ—Ç–∞
- ACK —Ç–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ **—Ä–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è**, –∞ –Ω–µ –Ω–∞ IP –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π

```go
// –ë—ã–ª–æ:
n, _, err := nm.udpConn.ReadFromUDP(buffer)
nm.sendAck(&msg, msg.FromIP)

// –°—Ç–∞–ª–æ:
n, remoteAddr, err := nm.udpConn.ReadFromUDP(buffer)
nm.sendAck(&msg, remoteAddr.IP.String())
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ –±–µ–∑ —Ä–µ—Ç—Ä–∞–µ–≤

---

#### üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
**–ü—Ä–æ–±–ª–µ–º–∞:** –û–¥–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–ª–∞—Å—å 8 —Ä–∞–∑ –∏–∑-–∑–∞ –ø–æ–≤—Ç–æ—Ä–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ TX ID –≤ –∫–æ—à–µ–ª—å–∫–∞—Ö –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
- –ö–∞–∂–¥–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
- –î—É–±–ª–∏–∫–∞—Ç—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è —Å –ª–æ–≥–æ–º

```go
// –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ Wallet –∏ Controller:
processedTxs    map[string]bool
processedTxsMu  sync.RWMutex

// –í handleTransaction:
if c.processedTxs[txData.TxID] {
    fmt.Printf("Skipping duplicate transaction: %s\n", txData.TxID[:8])
    return nil
}
c.processedTxs[txData.TxID] = true
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ 10 –º–æ–Ω–µ—Ç = —Ä–æ–≤–Ω–æ 10 –º–æ–Ω–µ—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–æ

---

## –í–µ—Ä—Å–∏—è 1.1 (2025-10-04)

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### üîß –£–ª—É—á—à–µ–Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** Lock grant —Ç–µ—Ä—è–ª—Å—è, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ –ø–æ–ª—É—á–∞–ª–∞—Å—å.

**–†–µ—à–µ–Ω–∏–µ:**
- `LOCK_REQUEST` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ –∫–∞–∂–¥–æ–º—É —É–∑–ª—É (–Ω–µ broadcast)
- –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è 3 —Ä–∞–∑–∞ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 100ms
- `LOCK_GRANT` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è 5 —Ä–∞–∑ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 200ms
- –¢–∞–π–º–∞—É—Ç —É–≤–µ–ª–∏—á–µ–Ω —Å 5 –¥–æ 10 —Å–µ–∫—É–Ω–¥

```go
// Send lock request to each node individually
for _, ip := range nodeIPs {
    go func(targetIP string) {
        msg := NewMessage(MsgLockRequest, w.profile.ID, w.profile.IP)
        msg.Data = data
        
        // Send with retry
        for i := 0; i < 3; i++ {
            w.network.SendTo(msg, targetIP)
            time.Sleep(100 * time.Millisecond)
        }
    }(ip)
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –Ω–∞–¥–µ–∂–Ω–æ

---

## –í–µ—Ä—Å–∏—è 1.0 (2025-10-04) - –ü–µ—Ä–≤—ã–π —Ä–µ–ª–∏–∑

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

‚úÖ **–î–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–µ—Ç—å –∫–æ—à–µ–ª—å–∫–æ–≤**
- UDP broadcast –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É–∑–ª–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π

‚úÖ **–î–≤–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã**
- `make run-controller` - –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å–µ—Ç–∏
- `make run-wallet` - –∫–æ—à–µ–ª–µ–∫

‚úÖ **–í—ã–±–æ—Ä —Å–µ—Ç–µ–≤–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

‚úÖ **–ü—Ä–æ—Ñ–∏–ª—å –∫–æ—à–µ–ª—å–∫–∞**
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `.wallet_profile.json`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ

‚úÖ **–ü—Ä–æ—Ç–æ–∫–æ–ª HELLO**
- –û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–∏ –≤ —Å–µ—Ç–∏
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —Å ACK

‚úÖ **–¢–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è**
- –•—Ä–∞–Ω–∏—Ç ID, IP, –±–∞–ª–∞–Ω—Å –∫–∞–∂–¥–æ–≥–æ –∫–æ—à–µ–ª—å–∫–∞
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –º–µ–∂–¥—É –≤—Å–µ–º–∏ —É–∑–ª–∞–º–∏

‚úÖ **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**
- –ö–æ–º–∞–Ω–¥–∞ `send <id> <amount>`
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞

‚úÖ **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞**
- –¢–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ó–∞–ø—Ä–æ—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —É –≤—Å–µ—Ö —É–∑–ª–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–Ω—è—Ç–∏–µ

‚úÖ **HTML Dashboard**
- –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —á–µ—Ä–µ–∑ WebSocket
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ç–∏
- –°–ø–∏—Å–æ–∫ –∫–æ—à–µ–ª—å–∫–æ–≤ —Å –±–∞–ª–∞–Ω—Å–∞–º–∏
- –ö—Ä–∞—Å–∏–≤—ã–π UI —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏

‚úÖ **CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
- `balance` - –ø–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å
- `table` - –ø–æ–∫–∞–∑–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å–µ—Ç–∏
- `send <id> <amount>` - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –º–æ–Ω–µ—Ç—ã
- `exit` - –≤—ã—Ö–æ–¥

---

## –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –≤ –±—É–¥—É—â–µ–º

- [ ] **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ë–î
- [ ] **–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** - –ª–æ–≥ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] **–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ–¥–ø–∏—Å–∏** - –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏
- [ ] **–ö–æ–Ω—Å–µ–Ω—Å—É—Å** - –∞–ª–≥–æ—Ä–∏—Ç–º Raft –∏–ª–∏ PBFT
- [ ] **REST API** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- [ ] **–ú—É–ª—å—Ç–∏–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä** - –≤—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
- [ ] **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** - iOS/Android –∫–ª–∏–µ–Ω—Ç

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** 1628 (Go)
```
742 —Å—Ç—Ä–æ–∫ - controller
886 —Å—Ç—Ä–æ–∫ - wallet
```

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- Go 1.21+
- UDP Broadcast
- WebSocket (gorilla/websocket)
- UUID (google/uuid)
- Vanilla JavaScript

**–ü—Ä–æ—Ç–æ–∫–æ–ª—ã:**
- 9 —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
- ACK –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- ‚úÖ 2+ —É–∑–ª–∞ –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏
- ‚úÖ –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚úÖ –ü–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–æ–≤
- ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —É–∑–ª–æ–≤
- ‚úÖ Dashboard –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

---

## –ö–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å—Å—è

```bash
# –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é
git pull origin main

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
make clean
make build

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
make run-controller  # –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
make run-wallet      # –∫–æ—à–µ–ª—å–∫–∏
```

---

**–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω:** 2025-10-04  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-04  
**–°—Ç–∞—Ç—É—Å:** –°—Ç–∞–±–∏–ª—å–Ω—ã–π ‚úÖ
